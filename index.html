<html>
<head>


    <link rel="import" href="import.html">

  <script>

    $(document).ready(function() {

      $('#navbar').load('navbar.html');
    });

    // var socket = io.connect('http://localhost:8888');
    // var socket = io.connect('http://192.168.1.15:8888');
    var socket = io.connect(domain);

    socket.on('sensor1', function (data) {

    //   $("#sensor1").text(data.raw);
        setupSensor1(data.raw);

    });

    socket.on('sensor2', function (data) {

    //   $("#sensor2").text(data.raw);
        setupSensor2(data.raw);

    });

    // socket.on('sensor3', function (data) {
      // $("#sensor3").text(data.raw);
    // });

    // socket.on('sensor4', function (data) {
      // $("#sensor4").text(data.raw);
    // });



    chartdata1 = [{x:1,y:1}, {x:2,y:10}, {x:3,y:5},{x:4,y:12}];
    chartdata2 = [{x:1,y:1}, {x:2,y:10}, {x:3,y:5},{x:4,y:12}];
    chartdata3 = [{x:1,y:1}, {x:2,y:10}, {x:3,y:5},{x:4,y:12}];
    chartdata4 = [{x:1,y:1}, {x:2,y:10}, {x:3,y:5},{x:4,y:12}];

    var lastx = 5;

    var data1 = {
      datasets: [{
        label: 'Vernier Ammonium (NO3)',
        data: chartdata1,
        backgroundColor: [
        'rgb(27, 201, 142)',
        ],
        borderColor : [
        'rgb(27, 201, 142)',
        ],
        fill: false,
      }]
    };


    var data2 = {
      datasets: [{
        label: 'Vernier Nitrate (NH4)',
        data: chartdata2,
        backgroundColor: [
        'rgb(230, 71, 89)',
        ],
        borderColor : [
        'rgb(230, 71, 89)',
        ],
        fill: false,
      }]
    };

    var data3 = {
      datasets: [{
        label: 'Altas pH',
        data: chartdata3,
        backgroundColor: [
        'rgb(159, 134, 255)',
        ],
        borderColor : [
        'rgb(159, 134, 255)',
        ],
        fill: false,
      }]
    };


    var data4 = {
      datasets: [{
        label: 'Altas ORP',
        data: chartdata4,
        backgroundColor: [
        'rgb(228, 216, 54)',
        ],
        borderColor : [
        'rgb(228, 216, 54)',
        ],
        fill: false,
      }]
    };
    var options =  {
        scales: {
            xAxes: [{
                type: 'linear',
                position: 'bottom'
            }]
        },

        title:{
            display : false,
            text : 'Title',
        }
    };

    var chart1, chart2, chart3, chart4;

    window.onload = function() {

      var ctx1 = document.getElementById("chart1");
      chart1 = new Chart(ctx1, {
        type: 'line',
        data: data1,
        options : options,
      });

      var ctx2 = document.getElementById("chart2");
      chart2 = new Chart(ctx2, {
        type: 'line',
        data: data2,
        options : options,
      });

      var ctx3 = document.getElementById("chart3");
      chart3 = new Chart(ctx3, {
        type: 'line',
        data: data3,
        options : options,
      });

      var ctx4 = document.getElementById("chart4");
      chart4 = new Chart(ctx4, {
        type: 'line',
        data: data4,
        options : options,
      });

    }

    function setupSensor1(data) {

        $("#sensor1").text(data);

        if (chartdata1.length >= 10) {chartdata1.shift()}

        var time = new Date();
        var time_format = time.getHours() + ':' + time.getMinutes() + ':'+time.getSeconds();
        console.log(time_format);

        chartdata1.push({x: lastx, y : data});
        lastx += 1;
        chart1.data.datasets[0].data = chartdata1;
        chart1.update();

    }

    function setupSensor2(data) {

        $("#sensor2").text(data);

        if (chartdata2.length >= 10) {chartdata2.shift()}
        chartdata2.push({x: lastx, y : data});
        lastx += 1;
        chart2.data.datasets[0].data = chartdata2;
        chart2.update();

    }

/*
    setInterval(function() {

      if (chartdata1.length >= 10) {chartdata1.shift()}
      if (chartdata2.length >= 10) {chartdata2.shift()}
      if (chartdata3.length >= 10) {chartdata3.shift()}
      if (chartdata4.length >= 10) {chartdata4.shift()}

      chartdata1.push({x: lastx, y : Math.random() * 10});
      chartdata2.push({x: lastx, y : Math.random() * 10});
      // chartdata3.push({x: lastx, y : Math.random() * 10});
      // chartdata4.push({x: lastx, y : Math.random() * 10});

      lastx += 1;
            // chartdata.shift();

            console.log("1 second");
            chart1.data.datasets[0].data = chartdata1;
            // myChart.data.datasets[0].data
            chart1.update();

            chart2.data.datasets[0].data = chartdata2;
            // myChart.data.datasets[0].data
            chart2.update();

            chart3.data.datasets[0].data = chartdata3;
            // myChart.data.datasets[0].data
            // chart3.update();

            chart4.data.datasets[0].data = chartdata4;
            // myChart.data.datasets[0].data
            // chart4.update();

          }, 3000);
*/

    function menuSelected() {

      console.log("menu selected");

    }


    function calibrate() {

      console.log("calibrate");
      prompt("Calibrate");

    }

        </script>

      </head>

      <body>

        <div id="navbar"></div>












            <div class="container-fluid">




              <div class="row">

                    <div class="col-md-6">
                      <div class="sensor-name-label">Vernier Ammonium (NO3)</div>
                      <div class="sensor-data-label" id="sensor1"></div>
                      <!-- <a href="#" onclick="calibrate();" class="btn btn-success" role="button">Calibrate</a> -->
                      <canvas id="chart1"></canvas>
                    </div>


                    <div class="col-md-6">
                      <div class="sensor-name-label">Vernier Nitrate (NH4)</div>

                      <div class="sensor-data-label" id="sensor2"></div>
                      <!-- <a href="csvfile.csv" class="btn btn-success" role="button">Calibrate</a> -->
                      <canvas id="chart2"></canvas>
                    </div>

              </div>


              <div class="row">

                    <div class="col-md-6">

                      <div class="sensor-name-label">Altas pH</div>

                      <div class="sensor-data-label" id="sensor3"></div>
                      <!-- <a href="csvfile.csv" class="btn btn-success" role="button">Calibrate</a> -->
                      <canvas id="chart3"></canvas>
                    </div>

                    <div class="col-md-6">

                      <div class="sensor-name-label">Altas ORP</div>

                      <div class="sensor-data-label" id="sensor4"></div>
                      <!-- <a href="csvfile.csv" class="btn btn-success" role="button">csv download</a> -->
                      <canvas id="chart4"></canvas>
                    </div>

              </div>



    </div>
















      </body>
      </html>
